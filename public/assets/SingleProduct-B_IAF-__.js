import{S as Kt,y as Wt,z as ot,A as Gt,B as Ht,j as Xt,C as D,D as Yt,E as Qt,G as ke,H as Jt,i as x,I as Zt,J as xt,K as Vt,L as er,M as tr,N as Te,O as rr,r as Y,P as b,f as Z,Q as nr,T as lt,U as sr,l as St,V as J,W as ir,X as or,Y as lr,Z as at,d as Je,c as H,o as X,a as V,$ as wt,q as Ze,t as Ae,_ as xe,a0 as At,a1 as ar,a2 as ur,a3 as cr,k as dr,a4 as fr,a5 as Ie,a6 as ut,n as ct,v as vr,e as Se,a7 as pe,F as Fe,p as Xe,a8 as mr}from"./index-C--IyZIX.js";var pr=class extends Kt{#t;#n=void 0;#e;#r;constructor(e,t){super(),this.#t=e,this.setOptions(t),this.bindMethods(),this.#s()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const t=this.options;this.options=this.#t.defaultMutationOptions(e),Wt(this.options,t)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#e,observer:this}),t?.mutationKey&&this.options.mutationKey&&ot(t.mutationKey)!==ot(this.options.mutationKey)?this.reset():this.#e?.state.status==="pending"&&this.#e.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#e?.removeObserver(this)}onMutationUpdate(e){this.#s(),this.#i(e)}getCurrentResult(){return this.#n}reset(){this.#e?.removeObserver(this),this.#e=void 0,this.#s(),this.#i()}mutate(e,t){return this.#r=t,this.#e?.removeObserver(this),this.#e=this.#t.getMutationCache().build(this.#t,this.options),this.#e.addObserver(this),this.#e.execute(e)}#s(){const e=this.#e?.state??Gt();this.#n={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#i(e){Ht.batch(()=>{if(this.#r&&this.hasListeners()){const t=this.#n.variables,r=this.#n.context,s={client:this.#t,meta:this.options.meta,mutationKey:this.options.mutationKey};e?.type==="success"?(this.#r.onSuccess?.(e.data,t,r,s),this.#r.onSettled?.(e.data,null,t,r,s)):e?.type==="error"&&(this.#r.onError?.(e.error,t,r,s),this.#r.onSettled?.(void 0,e.error,t,r,s))}this.listeners.forEach(t=>{t(this.#n)})})}};function hr(e,t){const r=Xt(),s=D(()=>r.defaultMutationOptions(Yt(e))),l=new pr(r,s.value),o=s.value.shallow?Qt(l.getCurrentResult()):ke(l.getCurrentResult()),m=l.subscribe(f=>{Jt(o,f)}),y=(f,E)=>{l.mutate(f,E).catch(()=>{})};x(s,()=>{l.setOptions(s.value)}),Zt(()=>{m()});const c=s.value.shallow?xt(o):Vt(o),d=er(c);return x(()=>o.error,f=>{if(f&&tr(s.value.throwOnError,[f]))throw f}),{...d,mutate:y,mutateAsync:o.mutate,reset:o.reset}}const gr=async e=>{if(e=="create")return{id:"",title:"",slug:"",description:"",price:0,stock:0,images:[],tags:[],sizes:[],gender:"",user:{}};try{const{data:t}=await Te.get(`/products/${e}`);return{...t,images:t.images.map(rr)}}catch(t){throw console.log(t),new Error(`Error getting product with ID ${e}`)}},yr=async e=>{const t=e.id,r=await Sr(e.images??[]);return e.images=r,e=br(e),t&&t!=""?await Or(t,e):await Vr(e)},br=e=>{const t=e.images?.map(r=>r.startsWith("http")?r.split("/").pop()?r:"":r)??[];return delete e.id,delete e.user,e.images=t,e},Or=async(e,t)=>{try{const{data:r}=await Te.patch(`/products/${e}`,t);return r}catch(r){throw console.log(r),new Error("Error al actaulizar producto")}},Vr=async e=>{try{const{data:t}=await Te.post("/products/",e);return t}catch(t){throw console.log(t),new Error("Error al crear producto")}},Sr=async e=>{const t=e.filter(o=>o instanceof File),r=e.filter(o=>typeof o=="string"),s=t.map(async o=>{try{const m=new FormData;m.append("file",o);const{data:y}=await Te.post("/files/product",m);return y.secureUrl}catch{throw new Error("Error al subir imagen")}}),l=await Promise.all(s);return[...r,...l]};/**
  * vee-validate v4.15.1
  * (c) 2025 Abdelrahman Awad
  * @license MIT
  */function Q(e){return typeof e=="function"}function he(e){return e==null}const ge=e=>e!==null&&!!e&&typeof e=="object"&&!Array.isArray(e);function et(e){return Number(e)>=0}function wr(e){return typeof e=="object"&&e!==null}function Ar(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}function dt(e){if(!wr(e)||Ar(e)!=="[object Object]")return!1;if(Object.getPrototypeOf(e)===null)return!0;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function Ee(e,t){return Object.keys(t).forEach(r=>{if(dt(t[r])&&dt(e[r])){e[r]||(e[r]={}),Ee(e[r],t[r]);return}e[r]=t[r]}),e}function Pe(e){const t=e.split(".");if(!t.length)return"";let r=String(t[0]);for(let s=1;s<t.length;s++){if(et(t[s])){r+=`[${t[s]}]`;continue}r+=`.${t[s]}`}return r}const Er={};function jr(e){return Er[e]}function ft(e,t,r){typeof r.value=="object"&&(r.value=A(r.value)),!r.enumerable||r.get||r.set||!r.configurable||!r.writable||t==="__proto__"?Object.defineProperty(e,t,r):e[t]=r.value}function A(e){if(typeof e!="object")return e;var t=0,r,s,l,o=Object.prototype.toString.call(e);if(o==="[object Object]"?l=Object.create(e.__proto__||null):o==="[object Array]"?l=Array(e.length):o==="[object Set]"?(l=new Set,e.forEach(function(m){l.add(A(m))})):o==="[object Map]"?(l=new Map,e.forEach(function(m,y){l.set(A(y),A(m))})):o==="[object Date]"?l=new Date(+e):o==="[object RegExp]"?l=new RegExp(e.source,e.flags):o==="[object DataView]"?l=new e.constructor(A(e.buffer)):o==="[object ArrayBuffer]"?l=e.slice(0):o.slice(-6)==="Array]"&&(l=new e.constructor(e)),l){for(s=Object.getOwnPropertySymbols(e);t<s.length;t++)ft(l,s[t],Object.getOwnPropertyDescriptor(e,s[t]));for(t=0,s=Object.getOwnPropertyNames(e);t<s.length;t++)Object.hasOwnProperty.call(l,r=s[t])&&l[r]===e[r]||ft(l,r,Object.getOwnPropertyDescriptor(e,r))}return l||e}const Et=Symbol("vee-validate-form"),Cr=Symbol("vee-validate-form-context"),Ir=typeof window<"u";function Fr(e){return Q(e)&&!!e.__locatorRef}function se(e){return!!e&&Q(e.parse)&&e.__type==="VVTypedSchema"}function jt(e){return!!e&&Q(e.validate)}function Pr(e){return e==="checkbox"||e==="radio"}function Nr(e){return ge(e)||Array.isArray(e)}function _r(e){return Array.isArray(e)?e.length===0:ge(e)&&Object.keys(e).length===0}function Me(e){return/^\[.+\]$/i.test(e)}function kr(e){return Ct(e)&&e.multiple}function Ct(e){return e.tagName==="SELECT"}function Tr(e){return It(e)&&e.target&&"submit"in e.target}function It(e){return e?!!(typeof Event<"u"&&Q(Event)&&e instanceof Event||e&&e.srcElement):!1}function ie(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r,s,l;if(Array.isArray(e)){if(r=e.length,r!=t.length)return!1;for(s=r;s--!==0;)if(!ie(e[s],t[s]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(s of e.entries())if(!t.has(s[0]))return!1;for(s of e.entries())if(!ie(s[1],t.get(s[0])))return!1;return!0}if(mt(e)&&mt(t))return!(e.size!==t.size||e.name!==t.name||e.lastModified!==t.lastModified||e.type!==t.type);if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(s of e.entries())if(!t.has(s[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(r=e.length,r!=t.length)return!1;for(s=r;s--!==0;)if(e[s]!==t[s])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(e=vt(e),t=vt(t),l=Object.keys(e),r=l.length,r!==Object.keys(t).length)return!1;for(s=r;s--!==0;)if(!Object.prototype.hasOwnProperty.call(t,l[s]))return!1;for(s=r;s--!==0;){var o=l[s];if(!ie(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function vt(e){return Object.fromEntries(Object.entries(e).filter(([,t])=>t!==void 0))}function mt(e){return Ir?e instanceof File:!1}function tt(e){return Me(e)?e.replace(/\[|\]/gi,""):e}function M(e,t,r){return e?Me(t)?e[tt(t)]:(t||"").split(/\.|\[(\d+)\]/).filter(Boolean).reduce((l,o)=>Nr(l)&&o in l?l[o]:r,e):r}function R(e,t,r){if(Me(t)){e[tt(t)]=r;return}const s=t.split(/\.|\[(\d+)\]/).filter(Boolean);let l=e;for(let o=0;o<s.length;o++){if(o===s.length-1){l[s[o]]=r;return}(!(s[o]in l)||he(l[s[o]]))&&(l[s[o]]=et(s[o+1])?[]:{}),l=l[s[o]]}}function Ye(e,t){if(Array.isArray(e)&&et(t)){e.splice(Number(t),1);return}ge(e)&&delete e[t]}function pt(e,t){if(Me(t)){delete e[tt(t)];return}const r=t.split(/\.|\[(\d+)\]/).filter(Boolean);let s=e;for(let o=0;o<r.length;o++){if(o===r.length-1){Ye(s,r[o]);break}if(!(r[o]in s)||he(s[r[o]]))break;s=s[r[o]]}const l=r.map((o,m)=>M(e,r.slice(0,m).join(".")));for(let o=l.length-1;o>=0;o--)if(_r(l[o])){if(o===0){Ye(e,r[0]);continue}Ye(l[o-1],r[o-1])}}function G(e){return Object.keys(e)}function Mr(e,t=void 0){const r=or();return r?.provides[e]||lr(e,t)}function ht(e,t=0){let r=null,s=[];return function(...l){return r&&clearTimeout(r),r=setTimeout(()=>{const o=e(...l);s.forEach(m=>m(o)),s=[]},t),new Promise(o=>s.push(o))}}function Rr(e,t){let r;return async function(...l){const o=e(...l);r=o;const m=await o;return o!==r?m:(r=void 0,t(m,l))}}function $r({get:e,set:t}){const r=Y(A(e()));return x(e,s=>{ie(s,r.value)||(r.value=A(s))},{deep:!0}),x(r,s=>{ie(s,e())||t(A(s))},{deep:!0}),r}function gt(e){return Array.isArray(e)?e:e?[e]:[]}function Ne(e,t){const r={};for(const s in e)t.includes(s)||(r[s]=e[s]);return r}function Ur(e){let t=null,r=[];return function(...s){const l=J(()=>{if(t!==l)return;const o=e(...s);r.forEach(m=>m(o)),r=[],t=null});return t=l,new Promise(o=>r.push(o))}}function Qe(e){if(Ft(e))return e._value}function Ft(e){return"_value"in e}function zr(e){return e.type==="number"||e.type==="range"?Number.isNaN(e.valueAsNumber)?e.value:e.valueAsNumber:e.value}function yt(e){if(!It(e))return e;const t=e.target;if(Pr(t.type)&&Ft(t))return Qe(t);if(t.type==="file"&&t.files){const r=Array.from(t.files);return t.multiple?r:r[0]}if(kr(t))return Array.from(t.options).filter(r=>r.selected&&!r.disabled).map(Qe);if(Ct(t)){const r=Array.from(t.options).find(s=>s.selected);return r?Qe(r):t.value}return zr(t)}function Dr(e){const t={};return Object.defineProperty(t,"_$$isNormalized",{value:!0,writable:!1,enumerable:!1,configurable:!1}),e?ge(e)&&e._$$isNormalized?e:ge(e)?Object.keys(e).reduce((r,s)=>{const l=Br(e[s]);return e[s]!==!1&&(r[s]=bt(l)),r},t):typeof e!="string"?t:e.split("|").reduce((r,s)=>{const l=Lr(s);return l.name&&(r[l.name]=bt(l.params)),r},t):t}function Br(e){return e===!0?[]:Array.isArray(e)||ge(e)?e:[e]}function bt(e){const t=r=>typeof r=="string"&&r[0]==="@"?qr(r.slice(1)):r;return Array.isArray(e)?e.map(t):e instanceof RegExp?[e]:Object.keys(e).reduce((r,s)=>(r[s]=t(e[s]),r),{})}const Lr=e=>{let t=[];const r=e.split(":")[0];return e.includes(":")&&(t=e.split(":").slice(1).join(":").split(",")),{name:r,params:t}};function qr(e){const t=r=>{var s;return(s=M(r,e))!==null&&s!==void 0?s:r[e]};return t.__locatorRef=e,t}const Kr={generateMessage:({field:e})=>`${e} is not valid.`,bails:!0,validateOnBlur:!0,validateOnChange:!0,validateOnInput:!1,validateOnModelUpdate:!0};let Wr=Object.assign({},Kr);const we=()=>Wr;async function Gr(e,t,r={}){const s=r?.bails,l={name:r?.name||"{field}",rules:t,label:r?.label,bails:s??!0,formData:r?.values||{}},o=await Hr(l,e);return Object.assign(Object.assign({},o),{valid:!o.errors.length})}async function Hr(e,t){const r=e.rules;if(se(r)||jt(r))return Yr(t,Object.assign(Object.assign({},e),{rules:r}));if(Q(r)||Array.isArray(r)){const y={field:e.label||e.name,name:e.name,label:e.label,form:e.formData,value:t},c=Array.isArray(r)?r:[r],d=c.length,f=[];for(let E=0;E<d;E++){const I=c[E],_=await I(t,y);if(!(typeof _!="string"&&!Array.isArray(_)&&_)){if(Array.isArray(_))f.push(..._);else{const K=typeof _=="string"?_:Nt(y);f.push(K)}if(e.bails)return{errors:f}}}return{errors:f}}const s=Object.assign(Object.assign({},e),{rules:Dr(r)}),l=[],o=Object.keys(s.rules),m=o.length;for(let y=0;y<m;y++){const c=o[y],d=await Qr(s,t,{name:c,params:s.rules[c]});if(d.error&&(l.push(d.error),e.bails))return{errors:l}}return{errors:l}}function Xr(e){return!!e&&e.name==="ValidationError"}function Pt(e){return{__type:"VVTypedSchema",async parse(r,s){var l;try{return{output:await e.validate(r,{abortEarly:!1,context:s?.formData||{}}),errors:[]}}catch(o){if(!Xr(o))throw o;if(!(!((l=o.inner)===null||l===void 0)&&l.length)&&o.errors.length)return{errors:[{path:o.path,errors:o.errors}]};const m=o.inner.reduce((y,c)=>{const d=c.path||"";return y[d]||(y[d]={errors:[],path:d}),y[d].errors.push(...c.errors),y},{});return{errors:Object.values(m)}}}}}async function Yr(e,t){const s=await(se(t.rules)?t.rules:Pt(t.rules)).parse(e,{formData:t.formData}),l=[];for(const o of s.errors)o.errors.length&&l.push(...o.errors);return{value:s.value,errors:l}}async function Qr(e,t,r){const s=jr(r.name);if(!s)throw new Error(`No such validator '${r.name}' exists.`);const l=Jr(r.params,e.formData),o={field:e.label||e.name,name:e.name,label:e.label,value:t,form:e.formData,rule:Object.assign(Object.assign({},r),{params:l})},m=await s(t,l,o);return typeof m=="string"?{error:m}:{error:m?void 0:Nt(o)}}function Nt(e){const t=we().generateMessage;return t?t(e):"Field is invalid"}function Jr(e,t){const r=s=>Fr(s)?s(t):s;return Array.isArray(e)?e.map(r):Object.keys(e).reduce((s,l)=>(s[l]=r(e[l]),s),{})}async function Zr(e,t){const s=await(se(e)?e:Pt(e)).parse(A(t),{formData:A(t)}),l={},o={};for(const m of s.errors){const y=m.errors,c=(m.path||"").replace(/\["(\d+)"\]/g,(d,f)=>`[${f}]`);l[c]={valid:!y.length,errors:y},y.length&&(o[c]=y[0])}return{valid:!s.errors.length,results:l,errors:o,values:s.value,source:"schema"}}async function xr(e,t,r){const l=G(e).map(async d=>{var f,E,I;const _=(f=r?.names)===null||f===void 0?void 0:f[d],B=await Gr(M(t,d),e[d],{name:_?.name||d,label:_?.label,values:t,bails:(I=(E=r?.bailsMap)===null||E===void 0?void 0:E[d])!==null&&I!==void 0?I:!0});return Object.assign(Object.assign({},B),{path:d})});let o=!0;const m=await Promise.all(l),y={},c={};for(const d of m)y[d.path]={valid:d.valid,errors:d.errors},d.valid||(o=!1,c[d.path]=d.errors[0]);return{valid:o,results:y,errors:c,source:"schema"}}let en=0;const _e=["bails","fieldsCount","id","multiple","type","validate"];function _t(e){const t=e?.initialValues||{},r=Object.assign({},b(t)),s=Z(e?.validationSchema);return s&&se(s)&&Q(s.cast)?A(s.cast(r)||{}):A(r)}function tn(e){var t;const r=en++,s=e?.name||"Form";let l=0;const o=Y(!1),m=Y(!1),y=Y(0),c=[],d=ke(_t(e)),f=Y([]),E=Y({}),I=Y({}),_=Ur(()=>{I.value=f.value.reduce((i,n)=>(i[Pe(b(n.path))]=n,i),{})});function B(i,n){const a=T(i);if(!a){typeof i=="string"&&(E.value[Pe(i)]=gt(n));return}if(typeof i=="string"){const u=Pe(i);E.value[u]&&delete E.value[u]}a.errors=gt(n),a.valid=!a.errors.length}function K(i){G(i).forEach(n=>{B(n,i[n])})}e?.initialErrors&&K(e.initialErrors);const oe=D(()=>{const i=f.value.reduce((n,a)=>(a.errors.length&&(n[b(a.path)]=a.errors),n),{});return Object.assign(Object.assign({},E.value),i)}),re=D(()=>G(oe.value).reduce((i,n)=>{const a=oe.value[n];return a?.length&&(i[n]=a[0]),i},{})),ye=D(()=>f.value.reduce((i,n)=>(i[b(n.path)]={name:b(n.path)||"",label:n.label||""},i),{})),be=D(()=>f.value.reduce((i,n)=>{var a;return i[b(n.path)]=(a=n.bails)!==null&&a!==void 0?a:!0,i},{})),le=Object.assign({},e?.initialErrors||{}),g=(t=e?.keepValuesOnUnmount)!==null&&t!==void 0?t:!1,{initialValues:v,originalInitialValues:O,setInitialValues:w}=nn(f,d,e),j=rn(f,d,O,re),C=D(()=>f.value.reduce((i,n)=>{const a=M(d,b(n.path));return R(i,b(n.path),a),i},{})),F=e?.validationSchema;function L(i,n){var a,u;const h=D(()=>M(v.value,b(i))),S=I.value[b(i)],p=n?.type==="checkbox"||n?.type==="radio";if(S&&p){S.multiple=!0;const W=l++;return Array.isArray(S.id)?S.id.push(W):S.id=[S.id,W],S.fieldsCount++,S.__flags.pendingUnmount[W]=!1,S}const N=D(()=>M(d,b(i))),k=b(i),U=ue.findIndex(W=>W===k);U!==-1&&ue.splice(U,1);const P=D(()=>{var W,Ve,Ke,We;const Ge=b(F);if(se(Ge))return(Ve=(W=Ge.describe)===null||W===void 0?void 0:W.call(Ge,b(i)).required)!==null&&Ve!==void 0?Ve:!1;const He=b(n?.schema);return se(He)&&(We=(Ke=He.describe)===null||Ke===void 0?void 0:Ke.call(He).required)!==null&&We!==void 0?We:!1}),z=l++,q=ke({id:z,path:i,touched:!1,pending:!1,valid:!0,validated:!!(!((a=le[k])===null||a===void 0)&&a.length),required:P,initialValue:h,errors:ir([]),bails:(u=n?.bails)!==null&&u!==void 0?u:!1,label:n?.label,type:n?.type||"default",value:N,multiple:!1,__flags:{pendingUnmount:{[z]:!1},pendingReset:!1},fieldsCount:1,validate:n?.validate,dirty:D(()=>!ie(Z(N),Z(h)))});return f.value.push(q),I.value[k]=q,_(),re.value[k]&&!le[k]&&J(()=>{fe(k,{mode:"silent"})}),lt(i)&&x(i,W=>{_();const Ve=A(N.value);I.value[W]=q,J(()=>{R(d,W,Ve)})}),q}const Re=ht(st,5),Oe=ht(st,5),je=Rr(async i=>await(i==="silent"?Re():Oe()),(i,[n])=>{const a=G(te.errorBag.value),h=[...new Set([...G(i.results),...f.value.map(S=>S.path),...a])].sort().reduce((S,p)=>{var N;const k=p,U=T(k)||$e(k),P=((N=i.results[k])===null||N===void 0?void 0:N.errors)||[],z=b(U?.path)||k,q=sn({errors:P,valid:!P.length},S.results[z]);return S.results[z]=q,q.valid||(S.errors[z]=q.errors[0]),U&&E.value[z]&&delete E.value[z],U?(U.valid=q.valid,n==="silent"||n==="validated-only"&&!U.validated||B(U,q.errors),S):(B(z,P),S)},{valid:i.valid,results:{},errors:{},source:i.source});return i.values&&(h.values=i.values,h.source=i.source),G(h.results).forEach(S=>{var p;const N=T(S);N&&n!=="silent"&&(n==="validated-only"&&!N.validated||B(N,(p=h.results[S])===null||p===void 0?void 0:p.errors))}),h});function ae(i){f.value.forEach(i)}function T(i){const n=typeof i=="string"?Pe(i):i;return typeof n=="string"?I.value[n]:n}function $e(i){return f.value.filter(a=>i.startsWith(b(a.path))).reduce((a,u)=>a?u.path.length>a.path.length?u:a:u,void 0)}let ue=[],ve;function $(i){return ue.push(i),ve||(ve=J(()=>{[...ue].sort().reverse().forEach(a=>{pt(d,a)}),ue=[],ve=null})),ve}function ee(i){return function(a,u){return function(S){return S instanceof Event&&(S.preventDefault(),S.stopPropagation()),ae(p=>p.touched=!0),o.value=!0,y.value++,me().then(p=>{const N=A(d);if(p.valid&&typeof a=="function"){const k=A(C.value);let U=i?k:N;return p.values&&(U=p.source==="schema"?p.values:Object.assign({},U,p.values)),a(U,{evt:S,controlledValues:k,setErrors:K,setFieldError:B,setTouched:De,setFieldTouched:Ce,setValues:Ue,setFieldValue:ne,resetForm:Be,resetField:rt})}!p.valid&&typeof u=="function"&&u({values:N,evt:S,errors:p.errors,results:p.results})}).then(p=>(o.value=!1,p),p=>{throw o.value=!1,p})}}}const de=ee(!1);de.withControlled=ee(!0);function kt(i,n){const a=f.value.findIndex(h=>h.path===i&&(Array.isArray(h.id)?h.id.includes(n):h.id===n)),u=f.value[a];if(!(a===-1||!u)){if(J(()=>{fe(i,{mode:"silent",warn:!1})}),u.multiple&&u.fieldsCount&&u.fieldsCount--,Array.isArray(u.id)){const h=u.id.indexOf(n);h>=0&&u.id.splice(h,1),delete u.__flags.pendingUnmount[n]}(!u.multiple||u.fieldsCount<=0)&&(f.value.splice(a,1),nt(i),_(),delete I.value[i])}}function Tt(i){G(I.value).forEach(n=>{n.startsWith(i)&&delete I.value[n]}),f.value=f.value.filter(n=>!n.path.startsWith(i)),J(()=>{_()})}const te={name:s,formId:r,values:d,controlledValues:C,errorBag:oe,errors:re,schema:F,submitCount:y,meta:j,isSubmitting:o,isValidating:m,fieldArrays:c,keepValuesOnUnmount:g,validateSchema:Z(F)?je:void 0,validate:me,setFieldError:B,validateField:fe,setFieldValue:ne,setValues:Ue,setErrors:K,setFieldTouched:Ce,setTouched:De,resetForm:Be,resetField:rt,handleSubmit:de,useFieldModel:Bt,defineInputBinds:Lt,defineComponentBinds:qt,defineField:qe,stageInitialValue:zt,unsetInitialValue:nt,setFieldInitialValue:Le,createPathState:L,getPathState:T,unsetPathValue:$,removePathState:kt,initialValues:v,getAllPathStates:()=>f.value,destroyPath:Tt,isFieldTouched:Rt,isFieldDirty:$t,isFieldValid:Ut};function ne(i,n,a=!0){const u=A(n),h=typeof i=="string"?i:i.path;T(h)||L(h),R(d,h,u),a&&fe(h)}function Mt(i,n=!0){G(d).forEach(a=>{delete d[a]}),G(i).forEach(a=>{ne(a,i[a],!1)}),n&&me()}function Ue(i,n=!0){Ee(d,i),c.forEach(a=>a&&a.reset()),n&&me()}function ze(i,n){const a=T(b(i))||L(i);return D({get(){return a.value},set(u){var h;const S=b(i);ne(S,u,(h=b(n))!==null&&h!==void 0?h:!1)}})}function Ce(i,n){const a=T(i);a&&(a.touched=n)}function Rt(i){const n=T(i);return n?n.touched:f.value.filter(a=>a.path.startsWith(i)).some(a=>a.touched)}function $t(i){const n=T(i);return n?n.dirty:f.value.filter(a=>a.path.startsWith(i)).some(a=>a.dirty)}function Ut(i){const n=T(i);return n?n.valid:f.value.filter(a=>a.path.startsWith(i)).every(a=>a.valid)}function De(i){if(typeof i=="boolean"){ae(n=>{n.touched=i});return}G(i).forEach(n=>{Ce(n,!!i[n])})}function rt(i,n){var a;const u=n&&"value"in n?n.value:M(v.value,i),h=T(i);h&&(h.__flags.pendingReset=!0),Le(i,A(u),!0),ne(i,u,!1),Ce(i,(a=n?.touched)!==null&&a!==void 0?a:!1),B(i,n?.errors||[]),J(()=>{h&&(h.__flags.pendingReset=!1)})}function Be(i,n){let a=A(i?.values?i.values:O.value);a=n?.force?a:Ee(O.value,a),a=se(F)&&Q(F.cast)?F.cast(a):a,w(a,{force:n?.force}),ae(u=>{var h;u.__flags.pendingReset=!0,u.validated=!1,u.touched=((h=i?.touched)===null||h===void 0?void 0:h[b(u.path)])||!1,ne(b(u.path),M(a,b(u.path)),!1),B(b(u.path),void 0)}),n?.force?Mt(a,!1):Ue(a,!1),K(i?.errors||{}),y.value=i?.submitCount||0,J(()=>{me({mode:"silent"}),ae(u=>{u.__flags.pendingReset=!1})})}async function me(i){const n=i?.mode||"force";if(n==="force"&&ae(p=>p.validated=!0),te.validateSchema)return te.validateSchema(n);m.value=!0;const a=await Promise.all(f.value.map(p=>p.validate?p.validate(i).then(N=>({key:b(p.path),valid:N.valid,errors:N.errors,value:N.value})):Promise.resolve({key:b(p.path),valid:!0,errors:[],value:void 0})));m.value=!1;const u={},h={},S={};for(const p of a)u[p.key]={valid:p.valid,errors:p.errors},p.value&&R(S,p.key,p.value),p.errors.length&&(h[p.key]=p.errors[0]);return{valid:a.every(p=>p.valid),results:u,errors:h,values:S,source:"fields"}}async function fe(i,n){var a;const u=T(i);if(u&&n?.mode!=="silent"&&(u.validated=!0),F){const{results:h}=await je(n?.mode||"validated-only");return h[i]||{errors:[],valid:!0}}return u?.validate?u.validate(n):(!u&&(a=n?.warn),Promise.resolve({errors:[],valid:!0}))}function nt(i){pt(v.value,i)}function zt(i,n,a=!1){Le(i,n),R(d,i,n),a&&!e?.initialValues&&R(O.value,i,A(n))}function Le(i,n,a=!1){R(v.value,i,A(n)),a&&R(O.value,i,A(n))}async function st(){const i=Z(F);if(!i)return{valid:!0,results:{},errors:{},source:"none"};m.value=!0;const n=jt(i)||se(i)?await Zr(i,d):await xr(i,d,{names:ye.value,bailsMap:be.value});return m.value=!1,n}const Dt=de((i,{evt:n})=>{Tr(n)&&n.target.submit()});nr(()=>{if(e?.initialErrors&&K(e.initialErrors),e?.initialTouched&&De(e.initialTouched),e?.validateOnMount){me();return}te.validateSchema&&te.validateSchema("silent")}),lt(F)&&x(F,()=>{var i;(i=te.validateSchema)===null||i===void 0||i.call(te,"validated-only")}),at(Et,te);function qe(i,n){const a=Q(n)?void 0:n?.label,u=T(b(i))||L(i,{label:a}),h=()=>Q(n)?n(Ne(u,_e)):n||{};function S(){var P;u.touched=!0,((P=h().validateOnBlur)!==null&&P!==void 0?P:we().validateOnBlur)&&fe(b(u.path))}function p(){var P;((P=h().validateOnInput)!==null&&P!==void 0?P:we().validateOnInput)&&J(()=>{fe(b(u.path))})}function N(){var P;((P=h().validateOnChange)!==null&&P!==void 0?P:we().validateOnChange)&&J(()=>{fe(b(u.path))})}const k=D(()=>{const P={onChange:N,onInput:p,onBlur:S};return Q(n)?Object.assign(Object.assign({},P),n(Ne(u,_e)).props||{}):n?.props?Object.assign(Object.assign({},P),n.props(Ne(u,_e))):P});return[ze(i,()=>{var P,z,q;return(q=(P=h().validateOnModelUpdate)!==null&&P!==void 0?P:(z=we())===null||z===void 0?void 0:z.validateOnModelUpdate)!==null&&q!==void 0?q:!0}),k]}function Bt(i){return Array.isArray(i)?i.map(n=>ze(n,!0)):ze(i)}function Lt(i,n){const[a,u]=qe(i,n);function h(){u.value.onBlur()}function S(N){const k=yt(N);ne(b(i),k,!1),u.value.onInput()}function p(N){const k=yt(N);ne(b(i),k,!1),u.value.onChange()}return D(()=>Object.assign(Object.assign({},u.value),{onBlur:h,onInput:S,onChange:p,value:a.value}))}function qt(i,n){const[a,u]=qe(i,n),h=T(b(i));function S(p){a.value=p}return D(()=>{const p=Q(n)?n(Ne(h,_e)):n||{};return Object.assign({[p.model||"modelValue"]:a.value,[`onUpdate:${p.model||"modelValue"}`]:S},u.value)})}const it=Object.assign(Object.assign({},te),{values:Vt(d),handleReset:()=>Be(),submitForm:Dt});return at(Cr,it),it}function rn(e,t,r,s){const l={touched:"some",pending:"some",valid:"every"},o=D(()=>!ie(t,Z(r)));function m(){const c=e.value;return G(l).reduce((d,f)=>{const E=l[f];return d[f]=c[E](I=>I[f]),d},{})}const y=ke(m());return St(()=>{const c=m();y.touched=c.touched,y.valid=c.valid,y.pending=c.pending}),D(()=>Object.assign(Object.assign({initialValues:Z(r)},y),{valid:y.valid&&!G(s.value).length,dirty:o.value}))}function nn(e,t,r){const s=_t(r),l=Y(s),o=Y(A(s));function m(y,c){c?.force?(l.value=A(y),o.value=A(y)):(l.value=Ee(A(l.value)||{},A(y)),o.value=Ee(A(o.value)||{},A(y))),c?.updateFields&&e.value.forEach(d=>{if(d.touched)return;const E=M(l.value,b(d.path));R(t,b(d.path),A(E))})}return{initialValues:l,originalInitialValues:o,setInitialValues:m}}function sn(e,t){return t?{valid:e.valid&&t.valid,errors:[...e.errors,...t.errors]}:e}function Ot(e){const t=Mr(Et,void 0),r=Y([]),s=()=>{},l={fields:r,remove:s,push:s,swap:s,insert:s,update:s,replace:s,prepend:s,move:s};if(!t||!Z(e))return l;const o=t.fieldArrays.find(g=>Z(g.path)===Z(e));if(o)return o;let m=0;function y(){return M(t?.values,b(e),[])||[]}function c(){const g=y();Array.isArray(g)&&(r.value=g.map((v,O)=>f(v,O,r.value)),d())}c();function d(){const g=r.value.length;for(let v=0;v<g;v++){const O=r.value[v];O.isFirst=v===0,O.isLast=v===g-1}}function f(g,v,O){if(O&&!he(v)&&O[v])return O[v];const w=m++;return{key:w,value:$r({get(){const C=M(t?.values,b(e),[])||[],F=r.value.findIndex(L=>L.key===w);return F===-1?g:C[F]},set(C){const F=r.value.findIndex(L=>L.key===w);F!==-1&&re(F,C)}}),isFirst:!1,isLast:!1}}function E(){d(),t?.validate({mode:"silent"})}function I(g){const v=b(e),O=M(t?.values,v);if(!O||!Array.isArray(O))return;const w=[...O];w.splice(g,1);const j=v+`[${g}]`;t.destroyPath(j),t.unsetInitialValue(j),R(t.values,v,w),r.value.splice(g,1),E()}function _(g){const v=A(g),O=b(e),w=M(t?.values,O),j=he(w)?[]:w;if(!Array.isArray(j))return;const C=[...j];C.push(v),t.stageInitialValue(O+`[${C.length-1}]`,v),R(t.values,O,C),r.value.push(f(v)),E()}function B(g,v){const O=b(e),w=M(t?.values,O);if(!Array.isArray(w)||!(g in w)||!(v in w))return;const j=[...w],C=[...r.value],F=j[g];j[g]=j[v],j[v]=F;const L=C[g];C[g]=C[v],C[v]=L,R(t.values,O,j),r.value=C,d()}function K(g,v){const O=A(v),w=b(e),j=M(t?.values,w);if(!Array.isArray(j)||j.length<g)return;const C=[...j],F=[...r.value];C.splice(g,0,O),F.splice(g,0,f(O)),R(t.values,w,C),r.value=F,E()}function oe(g){const v=b(e);t.stageInitialValue(v,g),R(t.values,v,g),c(),E()}function re(g,v){const O=b(e),w=M(t?.values,O);!Array.isArray(w)||w.length-1<g||(R(t.values,`${O}[${g}]`,v),t?.validate({mode:"validated-only"}))}function ye(g){const v=A(g),O=b(e),w=M(t?.values,O),j=he(w)?[]:w;if(!Array.isArray(j))return;const C=[v,...j];R(t.values,O,C),t.stageInitialValue(O+"[0]",v),r.value.unshift(f(v)),E()}function be(g,v){const O=b(e),w=M(t?.values,O),j=he(w)?[]:[...w];if(!Array.isArray(w)||!(g in w)||!(v in w))return;const C=[...r.value],F=C[g];C.splice(g,1),C.splice(v,0,F);const L=j[g];j.splice(g,1),j.splice(v,0,L),R(t.values,O,j),r.value=C,E()}const le={fields:r,remove:I,push:_,swap:B,insert:K,update:re,replace:oe,prepend:ye,move:be};return t.fieldArrays.push(Object.assign({path:e,reset:c},le)),sr(()=>{const g=t.fieldArrays.findIndex(v=>b(v.path)===b(e));g>=0&&t.fieldArrays.splice(g,1)}),x(y,g=>{const v=r.value.map(O=>O.value);ie(g,v)||c()}),le}const on=["type","value"],ln={key:0,class:"text-red-500"},an=Je({__name:"CustomInput",props:{modelValue:{},error:{},type:{default:"text"}},emits:["update:modelValue","blur"],setup(e){return(t,r)=>(X(),H("div",null,[r[2]||(r[2]=V("label",{for:"title",class:"form-label"},"Título",-1)),V("input",{type:e.type,value:e.modelValue,onInput:r[0]||(r[0]=s=>t.$emit("update:modelValue",s.target?.value)),onBlur:r[1]||(r[1]=s=>t.$emit("blur")),class:Ze(["form-control",{"border-red-500":e.error}])},null,42,on),e.error?(X(),H("span",ln,Ae(e.error),1)):wt("",!0)]))}}),un=xe(an,[["__scopeId","data-v-6c6a7c36"]]),cn=["type","value"],dn=Je({__name:"CustomTextArea",props:{modelValue:{},error:{},type:{default:"text"}},emits:["update:modelValue","blur"],setup(e){return(t,r)=>(X(),H("div",null,[V("textarea",{type:e.type,value:e.modelValue,onInput:r[0]||(r[0]=s=>t.$emit("update:modelValue",s.target?.value??"")),onBlur:r[1]||(r[1]=s=>t.$emit("blur")),class:Ze(["form-control",{"border-red-500":e.error}])},null,42,cn),At(V("span",{class:"text-red-400"},Ae(e.error),513),[[ar,e.error]])]))}}),fn=xe(dn,[["__scopeId","data-v-ace47837"]]),vn=fr({title:Ie().required().min(3),slug:Ie().required(),description:Ie().required(),price:ut().required(),stock:ut().required().min(1),gender:Ie().required().oneOf(["men","women","kid"])}),mn=Je({components:{CustomInput:un,CustomTextArea:fn},props:{productId:{type:String,required:!0}},setup(e){const t=ur(),r=cr(),{data:s,isError:l,isLoading:o,refetch:m}=dr({queryKey:["product",e.productId],queryFn:()=>gr(e.productId),retry:!1}),{mutate:y,isPending:c,isSuccess:d,data:f}=hr({mutationFn:yr}),{values:E,defineField:I,errors:_,handleSubmit:B,resetForm:K,meta:oe}=tn({validationSchema:vn}),[re,ye]=I("title"),[be,le]=I("slug"),[g,v]=I("description"),[O,w]=I("price"),[j,C]=I("stock"),[F,L]=I("gender"),{fields:Re}=Ot("images"),{fields:Oe,remove:je,push:ae}=Ot("sizes"),T=Y([]),$e=B(async $=>{const ee={...$,images:[...$.images,...T.value]};y(ee)}),ue=$=>{const ee=Oe.value.map(de=>de.value);ee.includes($)?je(ee.indexOf($)):ae($)},ve=$=>{const ce=$.target.files;if(ce&&ce.length!==0)for(const de of ce)T.value.push(de)};return St(()=>{l.value&&!o.value&&t.replace("/admin/products")}),x(s,()=>{s&&K({values:s.value})},{deep:!0,immediate:!0}),x(d,$=>{$&&(r.success("Producto actualizado con éxito"),t.replace(`/admin/products/${f.value.id}`),K({values:f.value}),T.value=[])}),x(()=>e.productId,()=>{m()}),{values:E,errors:_,meta:oe,title:re,titleAttrs:ye,slug:be,slugAttrs:le,description:g,descriptionAttrs:v,price:O,priceAttrs:w,stock:j,stockAttrs:C,gender:F,genderAttrs:L,sizes:Oe,images:Re,imageFiles:T,allSizes:["XS","S","M","L","XL","XXL"],isPending:c,onSubmit:$e,onFileChange:ve,toggleSize:ue,hasSize:$=>Oe.value.map(ce=>ce.value).includes($),tempUrl:$=>URL.createObjectURL($)}}}),pn={class:"bg-white px-5 py-2 rounded"},hn={class:"text-3xl"},gn={class:"text-blue-500"},yn={class:"first-col"},bn={class:"mb-4"},On={class:"mb-4"},Vn={class:"mb-4"},Sn={class:"flex flex-row gap-3"},wn={class:"mb-4 flex-1"},An={class:"mb-4 flex-1"},En={class:"mb-4"},jn={class:"flex"},Cn=["onClick"],In={class:"first-col"},Fn={class:"flex p-2 overflow-x-auto space-x-8 w-full h-[265px] bg-gray-200 rounded"},Pn=["src"],Nn=["src"],_n={class:"col-span-2 my-2"},kn={class:"mb-4"},Tn={key:0,class:"text-red-500"},Mn={class:"my-4 text-right"},Rn=["disabled"];function $n(e,t,r,s,l,o){const m=ct("CustomInput"),y=ct("CustomTextArea");return X(),H(Fe,null,[V("div",pn,[V("h1",hn,[t[8]||(t[8]=vr("Producto: ",-1)),V("small",gn,Ae(e.title),1)]),t[9]||(t[9]=V("hr",{class:"my-4"},null,-1))]),V("form",{class:"grid grid-cols-1 sm:grid-cols-2 bg-white px-5 gap-5",onSubmit:t[7]||(t[7]=(...c)=>e.onSubmit&&e.onSubmit(...c))},[V("div",yn,[V("div",bn,[t[10]||(t[10]=V("label",{for:"title",class:"form-label"},"Título",-1)),Se(m,pe({type:"text",modelValue:e.title,"onUpdate:modelValue":t[0]||(t[0]=c=>e.title=c)},e.titleAttrs,{error:e.errors.title}),null,16,["modelValue","error"])]),V("div",On,[t[11]||(t[11]=V("label",{for:"slug",class:"form-label"},"Slug",-1)),Se(m,pe({type:"text",modelValue:e.slug,"onUpdate:modelValue":t[1]||(t[1]=c=>e.slug=c)},e.slugAttrs,{error:e.errors.slug}),null,16,["modelValue","error"])]),V("div",Vn,[t[12]||(t[12]=V("label",{for:"description",class:"form-label"},"Descripción",-1)),Se(y,pe({modelValue:e.description,"onUpdate:modelValue":t[2]||(t[2]=c=>e.description=c)},e.descriptionAttrs,{error:e.errors.description}),null,16,["modelValue","error"])]),V("div",Sn,[V("div",wn,[t[13]||(t[13]=V("label",{for:"price",class:"form-label"},"Precio",-1)),Se(m,pe({type:"number",modelValue:e.price,"onUpdate:modelValue":t[3]||(t[3]=c=>e.price=c),modelModifiers:{number:!0}},e.priceAttrs,{error:e.errors.price}),null,16,["modelValue","error"])]),V("div",An,[t[14]||(t[14]=V("label",{for:"stock",class:"form-label"},"Inventario",-1)),Se(m,pe({type:"number",modelValue:e.stock,"onUpdate:modelValue":t[4]||(t[4]=c=>e.stock=c),modelModifiers:{number:!0}},e.stockAttrs,{error:e.errors.stock}),null,16,["modelValue","error"])])]),V("div",En,[t[15]||(t[15]=V("label",{for:"sizes",class:"form-label"},"Tallas",-1)),V("div",jn,[(X(!0),H(Fe,null,Xe(e.allSizes,c=>(X(),H("button",{key:c,onClick:d=>e.toggleSize(c),type:"button",class:Ze(["p-2 rounded w-14 mr-2 flex-1",{"bg-blue-500 text-white":e.hasSize(c),"bg-blue-100":!e.hasSize(c)}])},Ae(c),11,Cn))),128))])])]),V("div",In,[t[19]||(t[19]=V("label",{for:"stock",class:"form-label"},"Imágenes",-1)),V("div",Fn,[(X(!0),H(Fe,null,Xe(e.images,c=>(X(),H("div",{key:c.value,class:"flex-shrink-0"},[V("img",{src:c.value,alt:"imagen",class:"w-[250px] h-[250px]"},null,8,Pn)]))),128)),(X(!0),H(Fe,null,Xe(e.imageFiles,c=>(X(),H("div",{key:c.name,class:"flex-shrink-0"},[V("img",{src:e.tempUrl(c),alt:"imagen",class:"w-[250px] h-[250px]"},null,8,Nn)]))),128))]),V("div",_n,[t[16]||(t[16]=V("label",{for:"image",class:"form-label"},"Subir imagen",-1)),V("input",{multiple:"",type:"file",id:"image",class:"form-control",accept:"image/*",onChange:t[5]||(t[5]=(...c)=>e.onFileChange&&e.onFileChange(...c))},null,32)]),V("div",kn,[t[18]||(t[18]=V("label",{for:"stock",class:"form-label"},"Género",-1)),At(V("select",pe({"onUpdate:modelValue":t[6]||(t[6]=c=>e.gender=c)},e.genderAttrs,{class:"form-control"}),[...t[17]||(t[17]=[V("option",{value:""},"Seleccione",-1),V("option",{value:"kid"},"Niño",-1),V("option",{value:"women"},"Mujer",-1),V("option",{value:"men"},"Hombre",-1)])],16),[[mr,e.gender]]),e.errors.gender?(X(),H("span",Tn,Ae(e.errors.gender),1)):wt("",!0)]),V("div",Mn,[V("button",{disabled:e.isPending,type:"submit",class:"disabled:bg-blue-100 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"}," Guardar ",8,Rn)])])],32)],64)}const zn=xe(mn,[["render",$n],["__scopeId","data-v-5fc4edc8"]]);export{zn as default};
